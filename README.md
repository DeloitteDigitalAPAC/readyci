# Ready CI
A no-fuss CI/CD service and collection of build scripts

## Why use Ready CI?

### :+1: It comes with scripts
Ready CI comes with build scripts so that you spend less time setting up your automated CI/CD infrastructure, and get to making automated builds faster. Ready CI scripts currently support:
* iOS apps
* Maven projects


### :+1: Command-line or web-service
You can run Ready CI on the command-line within another CI environment like Jenkins, or run Ready CI as a service on it's own and accept web-hook calls from GIT services.

### :+1: Supports GIT web-hooks
Ready CI supports GIT commit web-hooks when you run it as a service so that your automated builds start as soon as you push to your git repository. Ready CI supports web-hooks from:
* GitHub
* BitBucket

### :+1: Parses iOS provisioning profiles
Configuring iOS builds is tricky. Ready CI uses the .mobileprovision file generated by Apple Developer Portal to automatically configure your build and remove some of the guess-work behind making your iOS app build successful.

### :+1: Handles whitespace
Paths, filenames and target names look great when you use whitespace. However, whitespace can be a nightmare to manage in CI scripts so Ready CI handles whitespace like a pro* so that your builds keep working while your project files are clean and readable.

\* The `pipeline` command-line parameter doesn't handle whitespace well. A work in process :-)

## How to use Ready CI
### Building Ready CI
Use Maven to create a jar: target/readyci-0.1.jar
```bash
$ mvn install
```

### Configure pipelines
Make your own copy of the `readyConfigExample.yml` file, specifying all of your pipelines and associated build tasks.

### Running a command-line build
Run a once off command-line build by specifying a `yml` configuration file and the `pipeline=` parameter. It's only fitting that Ready CI be able to build it's self! Try this out by using the example configuration `readyConfigExample.yml` to run a Ready CI build named `ready-ci`. 
```bash
$ java -jar target/readyci-0.1.jar readyConfigExample.yml pipeline=ready-ci

11:26:36.763 [main] INFO com.squarepolka.readyci.configuration.ReadyCIConfiguration - Loaded configuration readyConfigExample.yml with 2 pipelines
...
2018-06-13 11:26:41.768  INFO 44260 --- [           main] com.squarepolka.readyci.ReadyCI          : Ready CI is in command-line mode
2018-06-13 11:26:41.768  INFO 44260 --- [           main] com.squarepolka.readyci.ReadyCI          : Building pipline ready-ci
...
2018-06-13 12:30:58.429  INFO 48558 --- [           main] c.s.readyci.taskrunner.TaskRunner        : FINISHED BUILD 74e404d8-6bae-41fa-8aa1-4d786c797c58 
```

A successful build will deploy `readyci.jar` to your `/tmp/` directory. You can check that it's there like this:
```bash
$ ls -la /tmp/readyci.jar 
-rw-r--r--  1 bradley  wheel  16612035 Jun 13 12:30 /tmp/readyci.jar
```


### Running a build service
Ready CI can run as a web-service and listen out for web-hook calls. Configure your GIT repository to post to http://<your address>:8080/webhook and then run Ready CI with a `yml` configuration time and the `server` parameter.
```bash
java -jar target/readyci-0.1.jar readyConfigExample.yml server

11:26:36.763 [main] INFO com.squarepolka.readyci.configuration.ReadyCIConfiguration - Loaded configuration readyConfigExample.yml with 2 pipelines
...
2018-06-13 11:36:01.756  INFO 44416 --- [           main] com.squarepolka.readyci.ReadyCI          : Ready CI is in server mode
2018-06-13 11:36:01.758  INFO 44416 --- [           main] com.squarepolka.readyci.ReadyCI          : Started ReadyCI in 3.655 seconds (JVM running for 4.612)
```

You can test your web-hook using cURL
```bash
curl -X POST \
  http://localhost:8080/webhook \
  -H 'Cache-Control: no-cache' \
  -H 'Content-Type: application/json' \
  -d '{
   "push":{
      "changes":[
         {
            "new":{
               "type":"branch",
               "name":"master",
               "target":{
                  "author":{
                     "raw":"Bradley Clayton <me@cheese.toast.com>"
                  }
               }
            }
         }
      ]
   },
   "repository":{
      "name":"ready_ci"
   }
}'
```

This will kick off a build of Ready CI and you'll see output like this:
```bash
2018-06-13 12:36:19.232  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.webhook.WebHookPresenter     : Webhook proceeding with build for pipline ready-ci
2018-06-13 12:36:19.233  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : RUNNING BUILD c7a56eec-f303-4ad9-8de9-ffe5da68bef5 
2018-06-13 12:36:19.234  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : STARTING TASK build_path_clean | Finish up by cleaning the build folder
...
2018-06-13 12:36:19.276  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : STARTING TASK checkout_git |  
Cloning into '/tmp/readyci//c7a56eec-f303-4ad9-8de9-ffe5da68bef5'...
2018-06-13 12:36:21.918  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : COMPLETED TASK checkout_git
2018-06-13 12:36:21.918  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : STARTING TASK maven_install | Run maven install
2018-06-13 12:36:21.918 DEBUG 48786 --- [cTaskExecutor-2] com.squarepolka.readyci.tasks.Task       : Executing command: mvn install 
...
2018-06-13 12:36:26.996  INFO 48786 --- [cTaskExecutor-2] c.s.readyci.taskrunner.TaskRunner        : FINISHED BUILD c7a56eec-f303-4ad9-8de9-ffe5da68bef5 
```
Ready CI currently supports web-hook calls from GitHub and Bitbucket.
 